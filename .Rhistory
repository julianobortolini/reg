format(Sys.time(), "%H:%M", tz='America/Cuiaba')
format(Sys.time(), "%d/%m/%Y")
dados <- data.frame(ID, y, x1, x2)
dados
ID <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25)
y <- c(16.68, 11.50, 12.03, 14.88, 13.75, 18.11, 8.00, 17.83, 79.24, 21.50,
40.33, 21.00, 13.50, 19.75, 24.00, 29.00, 15.35, 19.00, 9.50, 35.10,
17.90, 52.32, 18.75, 19.83, 10.75)
x1 <- c(7, 3, 3, 4, 6, 7, 2, 7, 30, 5,
16, 10, 4, 6, 9, 10, 6, 7, 3, 17,
10, 26, 9, 8, 4)
x2 <- c(560, 220, 340, 80, 150, 330, 110, 210, 1460, 605,
688, 215, 255, 462, 448, 776, 200, 132, 36, 770,
140, 810, 450, 635, 150)
dados <- data.frame(ID, y, x1, x2)
dados
X <- cbind(1, x1, x2)
X
XlX
XlX <- t(X) %*% X
XlX
Xly <- t(X) %*% y
Xly
beta_hat <- solve(XlX) %*%  Xly
beta_hat
y_hat <- X %*% beta_hat # X %*% solve( t(X) %*% X ) %*%  t(X) %*% y
# Estimação de sigma2
y_hat <- X %*% beta_hat
# ou
# y_hat <- X %*% solve( t(X) %*% X ) %*%  t(X) %*% y
# ou
# H <- X %*% solve( t(X) %*% X ) %*%  t(X)
# y_hat <- H %*% y
e_hat <- y - y_hat
SQRes <- t(e_hat) %*% e_hat
GLRes <- length(y) - length(beta_hat)
QMRes <- SQRes / GLRes
sigma2_hat <- QMRes
# Teste de hipóteses:
# Análise de variância
# FV: total
GLTotal <- length(y) - 1
SQTotal <- t(y) %*% y - (sum(y)^2 / length(y))
# FV: regressão
GLReg <- length(beta_hat) - 1
SQReg <- t(beta_hat) %*% t(X) %*% y - (sum(y)^2 / length(y))
QMReg <- SQReg / GLReg
# FV: resíduos
GLRes <- GLTotal - GLReg
SQRes <- SQTotal - SQReg
QMRes <- SQRes / GLRes
QMRes
QMReg
# Teste F:
Fc <- QMReg / QMRes
Fc
Ftab <- qf(0.95, GLReg, GLRes)
Ftab
# OU
# Ftab <- qf(0.05, GLReg, GLRes, lower.tail = FALSE)
Fc > Ftab
C11 <- C[2,2]
C <- solve(XlX)
C11 <- C[2,2]
C11
sigma2_hat
sigma2_hat * C11
se_b1 <- sqrt(sigma2_hat * C11)
se_b1
b1 <- beta_hat[2]
tc_b1 <- b1 / se_b1
tc_b1
ttab <- qt(0.975, GLRes)
ttab
tc_b1 > ttab # rejeita ou não H0?
C <- solve(XlX)
C22 <- C["x2", "x2"]
# OU
C22 <- solve(XlX)[3, 3]
se_b2 <- sqrt(sigma2_hat * C22)
b2 <- beta_hat[3]
tc_b2 <- b2 / se_b2
tc_b2
ttab <- qt(0.975, GLRes)
tc_b2 > ttab # rejeita ou não H0?
IC_b1 <- c(b1 - talpha2 * se_b1, b1 + talpha2 * se_b1)
IC_b1
talpha2 <- qt(0.975, GLRes)
IC_b1 <- c(b1 - talpha2 * se_b1, b1 + talpha2 * se_b1)
IC_b1
b2
se_b2
IC_b2 <- c(b2 - talpha2 * se_b2, b2 + talpha2 * se_b2)
IC_b2
x0 <- c(1, 8, 275)
y0 <- x0 %*% beta_hat
y0
var_y0 <- t(x0) %*% C %*% x0 %*% sigma2_hat
var_y0
se_y0 <- sqrt(var_y0)
talpha2 <- qt(0.975, GLRes)
IC_y0 <- c(y0 - talpha2 * se_y0,
y0 + talpha2 * se_y0)
IC_y0
x0_new <- c(1, 8, 275)
y0_new <- x0_new %*% beta_hat
var_y0_new <- (1 + t(x0_new) %*% C %*% x0_new) %*% sigma2_hat
var_y0_new <- (1 + t(x0_new) %*% C %*% x0_new) %*% sigma2_hat
talpha2 <- qt(0.975, GLRes)
IC_y0_new <- c(y0_new - talpha2 * sqrt(var_y0_new),
y0_new + talpha2 * sqrt(var_y0_new))
IC_y0_new
# Comparando os ICs:
IC_y0 # Intervalo de Confiança
IC_y0_new # Intervalo de Predição
diff(IC_y0)
diff(IC_y0)
diff(IC_y0_new)
dados <- data.frame(idade, resistencia)
idade <- c(15.50, 23.75, 8.00, 17.00, 5.50, 19.00, 24.00, 2.50, 7.50, 11.00,
13.00, 3.75, 25.00, 9.75, 22.00, 18.00, 6.00, 12.50, 2.00, 21.50)
resistencia <- c(2158.70, 1678.15, 2316.00, 2061.30, 2207.50, 1708.30,
1784.70, 2575.00, 2357.90, 2256.70, 2165.20, 2399.55,
1779.80, 2336.75, 1765.30, 2053.50, 2414.40, 2200.50,
2654.20, 1753.70)
dados <- data.frame(idade, resistencia)
summary(dados)
sd(dados$idade)
sd(dados$resistencia)
plot(idade, resistencia)
cor(idade, resistencia)
cor.test(idade, resistencia)
?cor.test
plot(idade, resistencia, xlim = c(0,26), ylim = c(1600, 2700))
summary(modelo)
modelo <- lm(resistencia ~ idade)
modelo
summary(modelo)
anova(modelo)
summary(modelo)
residuos <- residuals(modelo)
SQRes <- sum(residuos^2)
SQRes
GL_Res <- length(idade) - length(coef(modelo))
GL_Res
QMRes <- SQRes / GL_Res
QMRes
sqrt(QMRes)
confint(modelo)
confint(modelo)
?confint
y_estimado <- predict(modelo, interval = "confidence")
y_estimado
dados <- data.frame(idade, resistencia, y_estimado)
head(dados)
preditos <- predict(modelo, interval = "confidence")
head(preditos)
colnames(preditos) <- c("y_estimado", "lim_inf", "lim_sup")
head(preditos)
dados <- data.frame(idade, resistencia, preditos)
head(dados)
colnames(preditos) <- c("resistencia_estimado", "lim_inf", "lim_sup")
head(preditos)
dados <- data.frame(idade, resistencia, preditos)
head(dados)
dados
plot(idade, resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência")
abline(modelo, col = "blue", lwd = 2)
plot(idade, resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência", data = dados)
abline(modelo, col = "blue", lwd = 2)
lines(idade, dados[,2], col = "red", lty = 2)
lines(dados$idade, dados$resistencia_estimado, col = "red", lty = 2)
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência")
#abline(modelo, col = "blue", lwd = 2)
lines(dados$idade, dados$resistencia_estimado, col = "red", lty = 2)
dados <- dados[order(dados$idade),]
dados
dados
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência")
#abline(modelo, col = "blue", lwd = 2)
lines(dados$idade, dados$resistencia_estimado, col = "red", lty = 2)
#abline(modelo, col = "blue", lwd = 2)
lines(dados$idade, dados$resistencia_estimado, col = "red", lty = 1)
#abline(modelo, col = "blue", lwd = 2)
lines(dados$idade, dados$resistencia_estimado,
col = "blue", lty = 1, lwd = 2)
# IC
lines(dados$idade, dados$lim_inf,
col = "blue", lty = 2, lwd = 2)
lines(dados$idade, dados$lim_sup,
col = "blue", lty = 2, lwd = 2)
lines(dados$idade, dados$lim_sup,
col = "blue", lty = 2, lwd = 2)
new_data <- data.frame(idade = seq(0,30, by = 0.1))
new_data <- data.frame(idade = seq(0,30, by = 0.1))
preditos_new <- predict(modelo, newdata = new_data,
interval = "prediction")
head(preditos_new)
new_data <- predict(modelo, newdata = new_data,
interval = "prediction")
new_data <- data.frame(idade = seq(0,30, by = 0.1))
preditos_new <- predict(modelo, newdata = new_data,
interval = "prediction")
preditos_new <- cbind(new_data, preditos_new)
head(preditos_new)
# dispersão
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência")
# valores estimados
lines(preditos_new$idade, preditos_new$fit,
col = "blue", lty = 1, lwd = 2)
# dispersão
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência",
xlim = c(0,30))
# dispersão
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência",
xlim = c(0,30))
tail(preditos_new)
# dispersão
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência",
xlim = c(0,30),
ylim = c(1500, 2700))
# valores estimados
lines(preditos_new$idade, preditos_new$fit,
col = "blue", lty = 1, lwd = 2)
# IP
lines(preditos_new$idade, preditos$lwr,
col = "brown", lty = 2, lwd = 2)
# IP
lines(preditos_new$idade, preditos_new$lwr,
col = "brown", lty = 2, lwd = 2)
lines(preditos_new$idade, preditos_new$upr,
col = "brown", lty = 2, lwd = 2)
# dispersão
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência",
xlim = c(0,30),
ylim = c(1250, 2850))
# valores estimados
lines(preditos_new$idade, preditos_new$fit,
col = "blue", lty = 1, lwd = 2)
# IP
lines(preditos_new$idade, preditos_new$lwr,
col = "brown", lty = 2, lwd = 2)
lines(preditos_new$idade, preditos_new$upr,
col = "brown", lty = 2, lwd = 2)
# dispersão
plot(dados$idade, dados$resistencia,
main = "Idade x Resistência",
xlab = "Idade (semanas)",
ylab = "Resistência",
xlim = c(0,30),
ylim = c(1250, 2850))
# valores estimados
lines(preditos_new$idade, preditos_new$fit,
col = "blue", lty = 1, lwd = 2)
# IC
lines(dados$idade, dados$lim_inf,
col = "blue", lty = 2, lwd = 2)
lines(dados$idade, dados$lim_sup,
col = "blue", lty = 2, lwd = 2)
# IP
lines(preditos_new$idade, preditos_new$lwr,
col = "brown", lty = 2, lwd = 2)
lines(preditos_new$idade, preditos_new$upr,
col = "brown", lty = 2, lwd = 2)
